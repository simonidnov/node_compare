var express=require("express"),product=express.Router(),Products_controller=require("../controllers/products_controller"),Auth_helper=require("../helpers/auth_helper"),language_helper=require("../helpers/languages_helper"),uri_helper=require("../helpers/uri_helper"),lang=require("../public/languages/auth_lang");product.use(function(e,t,r){t.setHeader("Access-Control-Allow-Origin","*"),t.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),t.setHeader("Access-Control-Allow-Methods","GET, PUT, POST, DELETE");e.query;"PUT"!==e.method&&"POST"!==e.method&&"DELETE"!==e.method||e.body,r()}),product.get("/",function(e,t,r){Products_controller.get(e,t,function(e){t.status(e.status).send(e.datas)})}).post("/",function(e,t,r){Auth_helper.validate_admin(e,function(r){200===r.status?Products_controller.create(e,t,function(e){console.log("Products_controller API callback sattus ? ",e),t.status(e.status).send(e.datas)}):t.redirect(301,'/auth?message="Vous n\'avez pas de droits administrateur sur la plateforme IDKIDS account"')})}).put("/",function(e,t,r){Auth_helper.validate_admin(e,function(r){200===r.status?Products_controller.update(e,t,function(e){t.status(e.status).send(e.datas)}):t.redirect(301,'/auth?message="Vous n\'avez pas de droits administrateur sur la plateforme IDKIDS account"')})}).delete("/",function(e,t,r){Auth_helper.validate_admin(e,function(r){200===r.status?Products_controller.deleting(e,t,function(e){t.status(e.status).send(e.datas)}):t.redirect(301,'/auth?message="Vous n\'avez pas de droits administrateur sur la plateforme IDKIDS account"')})}),module.exports=product;