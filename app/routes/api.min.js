var express=require("express"),api=express.Router(),Apps_controller=require("../controllers/apps_controller"),Auth_controller=require("../controllers/auth_controller"),Email_controller=require("../controllers/email_controller"),Auth_helper=require("../helpers/auth_helper"),language_helper=require("../helpers/languages_helper"),uri_helper=require("../helpers/uri_helper"),lang=require("../public/languages/auth_lang");api.use(function(e,t,s){t.setHeader("Access-Control-Allow-Origin","*"),t.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),t.setHeader("Access-Control-Allow-Methods","GET, PUT, POST, DELETE");var a=e.query;("PUT"===e.method||"POST"===e.method||"DELETE"===e.method)&&(a=e.body),s()}),api.get("/",function(e,t,s){t.status(200).send({title:"API"})}).post("/",function(e,t,s){Auth_helper.validate_admin(e,function(e){200===e.status?s():t.redirect(301,'/auth?message="Vous n\'avez pas de droits administrateur sur la plateforme IDKIDS account"')}),t.status(200).send({title:"POST API"})}).put("/",function(e,t,s){Auth_helper.validate_admin(e,function(e){200===e.status?s():t.redirect(301,'/auth?message="Vous n\'avez pas de droits administrateur sur la plateforme IDKIDS account"')}),t.status(200).send({title:"PUT API"})})["delete"]("/",function(e,t,s){Auth_helper.validate_admin(e,function(e){200===e.status?s():t.redirect(301,'/auth?message="Vous n\'avez pas de droits administrateur sur la plateforme IDKIDS account"')}),t.status(200).send({title:"DELETE API"})}).get("/apps",function(e,t,s){Apps_controller.get(e,t,function(e){t.status(e.status).send(e)})}).post("/apps",function(e,t,s){Apps_controller.create(e,t,function(e){t.status(e.status).send(e)})}).put("/apps",function(e,t,s){Apps_controller.update(e,t,function(e){t.status(e.status).send(e)})})["delete"]("/apps",function(e,t,s){Apps_controller["delete"](e,t,function(e){t.status(e.status).send(e)})}).post("/request_validation_code",function(e,t,s){Auth_controller.request_validation_code(e,t,function(s){200===s.status?Email_controller.validate_account(e,s,function(e){t.status(e.status).send(e)}):t.status(s.status).send(s)})}).put("/change_password",function(e,t,s){t.status(200).send({title:"POST UPDATE PASSWORD IS CURRENTLY ON TODO LIST"})}).get("/oauth/:any",function(e,t,s){t.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).post("/oauth/:any",function(e,t,s){t.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).put("/oauth/:any",function(e,t,s){t.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})})["delete"]("/oauth/:any",function(e,t,s){t.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).get("/send-sms",function(e,t,s){var a=require("request");a.post("https://textbelt.com/text",{form:{phone:"+33768651457",message:"Hello world",key:"57652f35ce6bd73e072a37701775ee0e3dec4194VPqWleqqdvVMWkw0VLpUasUvu"}},function(e,t,s){return e?void console.error("Error:",e):void console.log(JSON.parse(s))})}),module.exports=api;