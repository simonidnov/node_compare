var keyPublishable="",keySecret="",express=require("express"),stripe_test=express.Router();
stripe_test.use(function(a,b,d){b.setHeader("Access-Control-Allow-Origin","*");b.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept");b.setHeader("Access-Control-Allow-Methods","GET, PUT, POST, DELETE");app.locals.settings.StripeMode?(keyPublishable=app.locals.settings.StripekeyPublishable,keySecret=app.locals.settings.StripekeySecret):(keyPublishable=app.locals.settings.StripekeyPublishableTest,keySecret=app.locals.settings.StripekeySecretTest);stripe=require("stripe")(keySecret);
d()});stripe_test.get("/",function(a,b,d){b.render("stripe_test",{title:"Stripe",keyPublishable:keyPublishable,js:[],css:[]}).end()}).get("/charge",function(a,b){console.log("req.query ::::: ",a.query)}).post("/charge",function(a,b){console.log("req.body ::::: ",a.body);stripe.charges.create({amount:999,currency:"usd",description:"Example charge",source:a.body.stripeToken},function(a,c){a&&console.log("ERROR ----- ",a);c&&console.log("ERROR ----- ",c);b.send({charge:c}).end()})});module.exports=stripe_test;
