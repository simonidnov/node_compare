var express=require("express"),api=express.Router(),Apps_controller=require("../controllers/apps_controller"),Auth_controller=require("../controllers/auth_controller"),Email_controller=require("../controllers/email_controller"),Auth_helper=require("../helpers/auth_helper"),language_helper=require("../helpers/languages_helper"),uri_helper=require("../helpers/uri_helper"),lang=require("../public/languages/auth_lang");api.use(function(d,b,c){b.setHeader("Access-Control-Allow-Origin","*");b.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept");b.setHeader("Access-Control-Allow-Methods","GET, PUT, POST, DELETE");var a=d.query;if(d.method==="PUT"||d.method==="POST"||d.method==="DELETE"){a=d.body}c()});api.get("/",function(c,a,b){a.status(200).send({title:"API"})}).post("/",function(c,a,b){Auth_helper.validate_admin(c,function(d){if(d.status===200){b()}else{a.redirect(301,'/auth?message="Vous n\'avez pas de droits administrateur sur la plateforme IDKIDS account"')}});a.status(200).send({title:"POST API"})}).put("/",function(c,a,b){Auth_helper.validate_admin(c,function(d){if(d.status===200){b()}else{a.redirect(301,'/auth?message="Vous n\'avez pas de droits administrateur sur la plateforme IDKIDS account"')}});a.status(200).send({title:"PUT API"})}).get("/apps",function(c,a,b){Apps_controller.get(c,a,function(d){a.status(d.status).send(d)})}).post("/apps",function(c,a,b){Apps_controller.create(c,a,function(d){a.status(d.status).send(d)})}).put("/apps",function(c,a,b){Apps_controller.update(c,a,function(d){a.status(d.status).send(d)})}).post("/request_validation_code",function(c,a,b){Auth_controller.request_validation_code(c,a,function(d){if(d.status===200){Email_controller.validate_account(c,d,function(f){a.status(f.status).send(f)})}else{a.status(d.status).send(d)}})}).put("/change_password",function(c,a,b){Auth_controller.update_password(c,a,function(d){a.status(d.status).send(d)})}).get("/oauth/:any",function(c,a,b){a.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).post("/oauth/:any",function(c,a,b){a.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).put("/oauth/:any",function(c,a,b){a.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).get("/send-sms",function(d,a,b){var c=require("request");c.post("https://textbelt.com/text",{form:{phone:"+33768651457",message:"Hello world",key:"57652f35ce6bd73e072a37701775ee0e3dec4194VPqWleqqdvVMWkw0VLpUasUvu",},},function(g,f,e){if(g){console.error("Error:",g);return}console.log(JSON.parse(e))})});module.exports=api;