var express=require("express"),orders=express.Router(),Orders_controller=require("../controllers/orders_controller"),Auth_helper=require("../helpers/auth_helper"),language_helper=require("../helpers/languages_helper"),uri_helper=require("../helpers/uri_helper"),lang=require("../public/languages/auth_lang");
orders.use(function(c,b,d){b.setHeader("Access-Control-Allow-Origin","*");b.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept");b.setHeader("Access-Control-Allow-Methods","GET, PUT, POST, DELETE");Auth_helper.validate_admin(c,function(a){200===a.status?(c.body.isAdmin=!0,c.query.isAdmin=!0):(c.body.isAdmin=!1,c.query.isAdmin=!1)});Auth_helper.validate_session(c,function(a){200===a.status?d():b.status(a.status).send(a.datas)})});
orders.get("/",function(c,b,d){Orders_controller.get(c,b,function(a){b.status(a.status).send(a.datas)})}).get("/amount",function(c,b,d){Orders_controller.getAmount(c,b,function(a){b.status(a.status).send(a.datas)})}).post("/transaction",function(c,b,d){Orders_controller.createCharge(c,b,function(a){a.title="Paiement";b.status(a.status).render("order",a)})}).post("/",function(c,b,d){Orders_controller.create(c.body.data,b,function(a){200===a.status?b.status(a.status).send({status:a.status,response_display:{title:"Commande",
message:"Votre commande est pr\u00eate \u00e0 \u00eatre r\u00e9gl\u00e9e.",buttons:["OK"]}}):b.status(a.status).send(a)})}).put("/",function(c,b,d){Orders_controller.update(c.body.data,b,function(a){b.status(a.status).send({status:a.status,infos:a.datas})})})["delete"]("/",function(c,b,d){Orders_controller["delete"](c,b,function(a){b.status(a.status).send({status:a.status,infos:a.datas})})});module.exports=orders;
