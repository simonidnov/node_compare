var express=require("express"),router=express.Router(),language_helper=require("../helpers/languages_helper"),Page_controller=require("../controllers/pages_controller"),Apps_controller=require("../controllers/apps_controller"),uri_helper=require("../helpers/uri_helper"),lang=require("../public/languages/auth_lang"),apps=Apps_controller.getApps();
router.use(function(b,a,d){a.setHeader("Access-Control-Allow-Origin","*");a.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept");a.setHeader("Access-Control-Allow-Methods","GET, PUT, POST, DELETE");d()});router.get("/",function(b,a,d){a.render("offline",{title:"IDKIDS.community WELCOME"});a.end()});
router.get("/:page_url",function(b,a,d){Page_controller.get(b.params,a,function(c){1===c.datas.length?a.render("page_templates/"+c.datas[0].template,{title:c.datas[0].label+" - "+app.locals.settings.label,user:b.session.Auth,locale:language_helper.getlocale(b),lang:lang,page:c.datas[0].url,page_datas:c.datas[0],js:["/node_modules/swiper/dist/js/swiper.min.js","/public/javascripts/components/formular.min.js"],css:["/node_modules/swiper/dist/css/swiper.min.css","/public/stylesheets/components/formular.min.css"]}):
a.render("404",{title:"404",user:b.session.Auth,locale:language_helper.getlocale(b),lang:lang,page:b.params.page_name,page_datas:c.datas,js:["/node_modules/swiper/dist/js/swiper.min.js","/public/javascripts/components/formular.min.js"],css:["/node_modules/swiper/dist/css/swiper.min.css","/public/stylesheets/components/formular.min.css"]});a.end()})});module.exports=router;
