var express=require("express"),api=express.Router(),Apps_controller=require("../controllers/apps_controller"),Pages_controller=require("../controllers/pages_controller"),Auth_controller=require("../controllers/auth_controller"),Email_controller=require("../controllers/email_controller"),Auth_helper=require("../helpers/auth_helper"),language_helper=require("../helpers/languages_helper"),uri_helper=require("../helpers/uri_helper"),lang=require("../public/languages/auth_lang");api.use(function(t,e,s){e.setHeader("Access-Control-Allow-Origin","*"),e.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),e.setHeader("Access-Control-Allow-Methods","GET, PUT, POST, DELETE");t.query;"PUT"!==t.method&&"POST"!==t.method&&"DELETE"!==t.method||t.body,s()}),api.get("/",function(t,e,s){e.status(200).send({title:"API"})}).post("/",function(t,e,s){Auth_helper.validate_admin(t,function(t){200===t.status?e.status(200).send({title:"POST API"}):e.redirect(301,'/auth?message="Vous n\'avez pas de droits administrateur sur la plateforme IDKIDS account"')})}).put("/",function(t,e,s){Auth_helper.validate_admin(t,function(t){200===t.status?e.status(200).send({title:"PUT API"}):e.redirect(301,'/auth?message="Vous n\'avez pas de droits administrateur sur la plateforme IDKIDS account"')})}).delete("/",function(t,e,s){Auth_helper.validate_admin(t,function(t){200===t.status?s():e.redirect(301,'/auth?message="Vous n\'avez pas de droits administrateur sur la plateforme IDKIDS account"')}),e.status(200).send({title:"DELETE API"})}).get("/apps",function(t,e,s){Apps_controller.get(t,e,function(t){e.status(t.status).send(t)})}).get("/apps/:action",function(t,e,s){switch(console.log("req.body :::::: ",t),action){case"valid_sdk":Apps_controller.validate(t,e,function(t){e.status(t.status).send(t)});break;default:e.status(200).send({status:"Hello",title:"action non définie",message:"votre requête n'est pas reconnue par l'api"})}}).post("/apps",function(t,e,s){Apps_controller.create(t,e,function(t){e.status(t.status).send(t)})}).put("/apps",function(t,e,s){Apps_controller.update(t,e,function(t){e.status(t.status).send(t)})}).delete("/apps",function(t,e,s){Apps_controller.delete(t,e,function(t){e.status(t.status).send(t)})}).get("/pages",function(t,e,s){Pages_controller.get(t,e,function(t){e.status(t.status).send(t)})}).post("/pages",function(t,e,s){Pages_controller.create(t,e,function(t){e.status(t.status).send(t)})}).put("/pages",function(t,e,s){Pages_controller.update(t,e,function(t){e.status(t.status).send(t)})}).delete("/pages",function(t,e,s){Pages_controller.delete(t,e,function(t){e.status(t.status).send(t)})}).post("/request_validation_code",function(t,e,s){Auth_controller.request_validation_code(t,e,function(s){200===s.status?Email_controller.validate_account(t,s,function(t){e.status(t.status).send(t)}):e.status(s.status).send(s)})}).put("/change_password",function(t,e,s){Auth_controller.update_password(t,e,function(t){e.status(t.status).send(t)})}).get("/users/:any",function(t,e,s){e.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).post("/users/:any",function(t,e,s){e.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).put("/users/:any",function(t,e,s){e.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).delete("/users/:any",function(t,e,s){Auth_controller.unregister(t,e,function(t){e.status(200).send({title:"USER DELETED",datas:t})})}).get("/oauth/:any",function(t,e,s){e.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).post("/oauth/:any",function(t,e,s){e.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).put("/oauth/:any",function(t,e,s){e.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).delete("/oauth/:any",function(t,e,s){e.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).get("/send-sms",function(t,e,s){require("request").post("https://textbelt.com/text",{form:{phone:"+33768651457",message:"Hello world",key:"57652f35ce6bd73e072a37701775ee0e3dec4194VPqWleqqdvVMWkw0VLpUasUvu"}},function(t,e,s){if(t)return void console.error("Error:",t);console.log(JSON.parse(s))})}),module.exports=api;