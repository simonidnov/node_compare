var express=require("express"),checking_session=express.Router(),Auth_model=require("../models/auth_model"),auth_helper=require("../helpers/auth_helper"),language_helper=require("../helpers/languages_helper"),uri_helper=require("../helpers/uri_helper"),lang=require("../public/languages/auth_lang");checking_session.use(function(e,s,r){s.setHeader("Access-Control-Allow-Origin","*"),s.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),s.setHeader("Access-Control-Allow-Methods","GET, PUT, POST, DELETE"),r()}),checking_session.get("/",function(e,s,r){void 0!==e.query._id&&void 0!==e.query.secret&&void 0!==e.query.token?Auth_model.checking_session(e,e.query._id,function(e){void 0!==e.datas.password?s.redirect(307,"/account?idkids-token="+e.datas.token+"&idkids-id="+e.datas._id+"&idkids-device="+e.datas.current_device):s.render("auth/login",{})}):s.render("auth/checking_session",{})}),module.exports=checking_session;