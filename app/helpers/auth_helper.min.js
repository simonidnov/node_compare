const db=require("mongoose"),config=require("../config/config"),Auth_model=require("../models/auth_model"),machineId=require("node-machine-id"),device_uid=machineId.machineIdSync({original:!0});module.exports={validate_from:function(e,s){return"undefined"==typeof e.options.secret||"undefined"==typeof e.options.from_origin?!1:"000-000-000"!==e.options.secret||"http://localhost:3000"!==e.options.from_origin&&"http://localhost:8080"!==e.options.from_origin||-1===e.options.from_origin.indexOf(s)?(console.log(" ---------------- UNAUTHORIZED ---------------------- "),console.log(" ---------------- UNAUTHORIZED ---------------------- "),console.log(" ---------------- UNAUTHORIZED ---------------------- "),console.log(" ---------------- UNAUTHORIZED ---------------------- "),console.log(" ---------------- UNAUTHORIZED ---------------------- "),console.log(" ---------------- UNAUTHORIZED ---------------------- "),console.log(" ---------------- UNAUTHORIZED ---------------------- "),console.log(" ---------------- UNAUTHORIZED ---------------------- "),console.log(" ---------------- UNAUTHORIZED ---------------------- "),console.log(" ---------------- UNAUTHORIZED ---------------------- "),console.log(" ---------------- UNAUTHORIZED ---------------------- "),console.log(" ---------------- UNAUTHORIZED ---------------------- "),console.log(" ---------------- UNAUTHORIZED ---------------------- "),!1):!0},validate_user:function(e,s,t){"undefined"==typeof e.options.user_id&&t({status:401,message:"UNAUTHARISED need valid user ID"}),"undefined"==typeof e.options.user_secret&&t({status:401,message:"UNAUTHARISED need valid user secret"}),"undefined"==typeof e.options.user_token&&t({status:401,message:"UNAUTHARISED need valid user token"}),db.connect(config.database.users,{useMongoClient:!0}),e.options.device_uid=device_uid,Auth_model.check_user(e,function(e){t(e)})},validate_session:function(e,s){s("undefined"==typeof e.session.Auth?{status:401,message:"UNAUTHAURIZED"}:{status:200,message:"UNAUTHAURIZED"})},check_session:function(e,s,t){console.log("-------------------------------- RESET SESSION --------------------------------------------- ",s),console.log("-------------------------------- user_id --------------------------------------------- ",s),Auth_model.reset_session(e,s,t)}};