const db=require("mongoose"),config=require("../config/config"),basket_datas={products:{type:"Object",datas:{product_id:{type:"string"},quantity:{type:"number"},datas:{type:"Object"}}},created:{type:"Date",default:Date.now},updated:{type:"Date",default:Date.now}};0===db.connection.readyState&&db.connect(config.database.users,{useMongoClient:!0});const basketSchemas=new db.Schema(basket_datas),Baskets=db.model("Baskets",basketSchemas);module.exports={attributes:basket_datas},module.exports.get=function(t,e,s){var a={};Baskets.find(a,function(t,e){s(t?{status:405,datas:t}:{status:200,datas:e})})},module.exports.create=function(t,e,s){datas.secret=jwt.sign({secret:user_id},config.secrets.global.secret),datas.token=jwt.sign({secret:user_id+Date.now()},config.secrets.global.secret),new_basket=new Baskets(datas),new_basket.save(function(t,e){s(t?{status:405,message:t}:{status:200,datas:e})})},module.exports.update=function(t,e,s){delete datas.options,delete datas._id;datas.updated=Date.now(),Baskets.updateOne({_id:t.body._id},{$set:datas},function(t,e){s(t?{status:405,message:t}:{status:200,apps:e})})},module.exports.delete=function(t,e,s){Baskets.deleteOne({_id:t.body._id},function(t,e){s(t?{status:405,message:t}:{status:200,apps:e})})};