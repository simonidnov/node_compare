var express=require("express"),_=require("underscore"),admin=express.Router(),Auth_model=require("../models/auth_model"),Auth_helper=require("../helpers/auth_helper"),Apps_controller=require("../controllers/apps_controller"),Pages_controller=require("../controllers/pages_controller"),language_helper=require("../helpers/languages_helper"),uri_helper=require("../helpers/uri_helper"),lang=require("../public/languages/auth_lang");admin.use(function(c,a,b){a.setHeader("Access-Control-Allow-Origin","*");a.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept");a.setHeader("Access-Control-Allow-Methods","GET, PUT, POST, DELETE");Auth_helper.validate_session(c,function(d){console.log(d);if(d.status===200){Auth_helper.validate_admin(c,function(f){if(f.status===200){b()}else{a.redirect(301,'/auth?message="Vous n\'avez pas de droits administrateur sur la plateforme IDKIDS account"')}})}else{a.redirect(301,"/auth")}})});admin.get("/",function(c,a,b){return a.render("admin/dashboard",{title:"Admin Dashboard",user:c.session.Auth,locale:language_helper.getlocale(),lang:lang,page:"dashboard",js:["/public/javascripts/admin/dashboard.js","/public/javascripts/components/formular.js","/node_modules/qrcode/build/qrcode.min.js"],css:["/public/stylesheets/admin/admin.css","/public/stylesheets/admin/dashboard.css","/public/stylesheets/components/formular.css"]})}).get("/dashboard",function(c,a,b){a.render("admin/dashboard",{title:"Admin Dashboard",user:c.session.Auth,locale:language_helper.getlocale(),lang:lang,page:"dashboard",js:["/public/javascripts/admin/dashboard.js","/public/javascripts/components/formular.js","/node_modules/qrcode/build/qrcode.min.js"],css:["/public/stylesheets/admin/admin.css","/public/stylesheets/admin/dashboard.css","/public/stylesheets/components/formular.css"]})}).get("/apps",function(c,a,b){var d=[];Apps_controller.get(c,a,function(f){d=f.datas;a.status(f.status).render("admin/apps",{title:"Admin Dashboard",user:c.session.Auth,locale:language_helper.getlocale(),lang:lang,page:"apps",applications:d,js:["/public/javascripts/admin/apps.js","/node_modules/cropperjs/dist/cropper.min.js","/public/javascripts/components/formular.js","/node_modules/qrcode/build/qrcode.min.js"],css:["/public/stylesheets/admin/admin.css","/node_modules/cropperjs/dist/cropper.min.css","/public/stylesheets/admin/apps.css","/public/stylesheets/components/formular.css"]})});return}).get("/apps/:page",function(c,a,b){var d=null;Apps_controller.get(c,a,function(f){d=f.datas;a.render("admin/apps",{title:"Application",user:c.session.Auth,locale:language_helper.getlocale(),lang:lang,page:c.params.page,applications:d,js:["/public/javascripts/admin/apps.js","/node_modules/cropperjs/dist/cropper.min.js","/public/javascripts/components/formular.js","/node_modules/qrcode/build/qrcode.min.js"],css:["/public/stylesheets/admin/admin.css","/node_modules/cropperjs/dist/cropper.min.css","/public/stylesheets/admin/apps.css","/public/stylesheets/components/formular.css"]})});return}).get("/apps/:page/:_id",function(d,b,c){var e=null;var a=null;Apps_controller.get(d,b,function(f){e=f.datas;a=_.where(JSON.parse(JSON.stringify(e)),{_id:d.params._id})[0];b.render("admin/apps",{title:"Admin Dashboard",user:d.session.Auth,locale:language_helper.getlocale(),lang:lang,page:d.params.page,applications:e,app_id:d.params._id,edit_application:a,_:_,js:["/public/javascripts/admin/apps.js","/node_modules/cropperjs/dist/cropper.min.js","/public/javascripts/components/formular.js","/node_modules/qrcode/build/qrcode.min.js"],css:["/public/stylesheets/admin/admin.css","/node_modules/cropperjs/dist/cropper.min.css","/public/stylesheets/admin/apps.css","/public/stylesheets/components/formular.css"]})});return}).get("/users",function(d,a,c){var b=require("../controllers/auth_controller");b.get(d,a,function(f){a.render("admin/users",{title:"Admin Users",user:d.session.Auth,locale:language_helper.getlocale(),lang:lang,page:"users",users:f.users,js:["/public/javascripts/admin/users.js","/public/javascripts/components/formular.js","/node_modules/qrcode/build/qrcode.min.js","/public/javascripts/farnientejs/farnientejs.min.js"],css:["/public/stylesheets/admin/admin.css","/public/stylesheets/ui.css","/public/stylesheets/admin/users.css","/public/stylesheets/components/formular.css"]})})}).get("/notifications",function(c,a,b){a.render("admin/notifications",{title:"Admin Notifications",user:c.session.Auth,locale:language_helper.getlocale(),lang:lang,page:"notifications",js:["/public/javascripts/admin/notifications.js","/public/javascripts/components/formular.js","/node_modules/qrcode/build/qrcode.min.js"],css:["/public/stylesheets/admin/admin.css","/public/stylesheets/admin/notifications.css","/public/stylesheets/components/formular.css"]})}).get("/settings",function(c,a,b){a.render("admin/settings",{title:"Admin Settings",user:c.session.Auth,locale:language_helper.getlocale(),lang:lang,page:"settings",pages:pages,js:["/public/javascripts/admin/notifications.js","/public/javascripts/components/formular.js","/node_modules/qrcode/build/qrcode.min.js"],css:["/public/stylesheets/admin/admin.css","/public/stylesheets/admin/notifications.css","/public/stylesheets/components/formular.css"]})}).get("/pages",function(c,a,b){Pages_controller.get(c,a,function(d){pages=d.datas;a.render("admin/pages",{title:"Admin Pages",user:c.session.Auth,locale:language_helper.getlocale(),lang:lang,page:"pages",js:["/public/javascripts/admin/pages.js","/public/javascripts/components/formular.js","/node_modules/qrcode/build/qrcode.min.js"],css:["/public/stylesheets/admin/admin.css","/public/stylesheets/admin/pages.css","/public/stylesheets/components/formular.css"]})})}).get("/pages/:page",function(c,a,b){var d=null;Pages_controller.get(c,a,function(f){pages=f.datas;a.render("admin/pages",{title:"Admin Pages",user:c.session.Auth,locale:language_helper.getlocale(),lang:lang,page:c.params.page,pages:pages,js:["/public/javascripts/admin/pages.js","/public/javascripts/components/formular.js","/node_modules/qrcode/build/qrcode.min.js"],css:["/public/stylesheets/admin/admin.css","/public/stylesheets/admin/pages.css","/public/stylesheets/components/formular.css"]})});return}).get("/pages/:page/:_id",function(e,c,d){var a=null;var b=null;Pages_controller.get(e,c,function(f){a=f.datas;edit_page=_.where(JSON.parse(JSON.stringify(a)),{_id:e.params._id})[0];c.render("admin/pages",{title:"Admin Pages",user:e.session.Auth,locale:language_helper.getlocale(),lang:lang,page:e.params.page,pages:a,page_id:e.params._id,edit_page:edit_page,_:_,js:["/public/javascripts/admin/pages.js","/public/javascripts/components/pager/pager.js","/node_modules/cropperjs/dist/cropper.min.js","/public/javascripts/components/formular.js","/node_modules/qrcode/build/qrcode.min.js"],css:["/public/stylesheets/admin/admin.css","/node_modules/cropperjs/dist/cropper.min.css","/public/stylesheets/admin/pages.css","/public/stylesheets/components/formular.css","/public/stylesheets/components/pager/pager.css"]})});return});module.exports=admin;