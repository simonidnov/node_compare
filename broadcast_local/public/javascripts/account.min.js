"use strict";$(function(){account.init()});var account={user:null,sdk:null,init:function(){$(".hor_nav").animate({scrollLeft:$(".hor_nav li.selected").position().left+$(".hor_nav").scrollLeft()-50},500),this.sdk=new idkids_jssdk({secret:"000-000-000",callback_url:"http://localhost:3000/account/",authorisation:{basket:!0,friends:!0,profile:!0,members:!0,email:!0,mobile:!0,address:!0,badges:!0,newsletter:!0,wallet:!0,loyalty_card:!0}},function(t,e){console.log(t,e)}),this.sdk.init(function(t){console.log("init status ",t)}),this.sdk.getLoginStatus(function(t){console.log("getLoginStatus ::: ",t),QRCode.toCanvas(document.getElementById("canvas"),t.id,function(t){t&&console.error(t),console.log("success!")})}),$("[data-action]").off("click").on("click",function(t){t.preventDefault();var e=$(this).attr("data-action");switch(e){case"page_reload":window.history.pushState({pageTitle:$(this).attr("title")},"",account.add_params($(this).attr("href"))),account.navigate();break;default:console.log("default ",e)}}),window.addEventListener("popstate",this.navigate)},navigate:function(){var t=this.parse_url(window.location.pathname);$("[data-for]").removeClass("selected"),$('[data-for="'+t.account+'"]').addClass("selected"),$.each($("[data-for]"),function(t,e){$("#"+$(this).attr("data-for")).css("display","none")}),$("#"+t.account).css("display","block"),$(".hor_nav").animate({scrollLeft:$(".hor_nav li.selected").position().left+$(".hor_nav").scrollLeft()-50},500)},parse_url:function(t){for(var e=[],s=t.split("/"),i=1;i<s.length;i+=2)e.push({}),e[s[i]]=s[i+1];return e},add_params:function(t){return t}},idkids_jssdk=function(t,e){this.options=t,this.callback=e,this.inited=!1,this.api={user:null,options:null,get:function(t,e,s){this.save_account(),s(t,e)},post:function(t,e,s){},put:function(t,e,s){},"delete":function(t,e,s){},get_user_status:function(){return this.set_user(),null===this.user?{status:"not_connected",infos:"call api.get('me')"}:{status:"logged",token:this.user.token,id:this.user.id,device:this.user.device}},get_params:function(){},add_params:function(){var t=this.options;return t.from_origin=window.location.origin,t.user_token=this.user.token,t.user_id=this.user._id,t.user_secret=this.user.secret,t.user_device=this.user.current_device,t},reset_user:function(t){var e=new URL(window.location.href),s=e.searchParams.get("idkids-token");if(null!==s){var i={token:e.searchParams.get("idkids-token"),id:e.searchParams.get("idkids-id"),device:e.searchParams.get("idkids-device")};window.localStorage.setItem("idkids_local_user",JSON.stringify(i)),this.set_user(),t(i)}},set_user:function(){try{this.user=JSON.parse(window.localStorage.getItem("idkids_local_user"))}catch(t){console.log("error ::: ",t)}}},this.api.options=t,this.init=function(t){if(null!==document.getElementById("idkids-dsk"))return!0;var e=document.createElement("div");e.id="idkids-dsk",this.api.reset_user(function(t){console.log("reset user ",t)}),t({status:"inited"}),this.inited=!0},this.getLoginStatus=function(t){t(this.api.get_user_status())},this.createAuthbutton=function(t,e){null===document.getElementById(t)?e({status:"error",message:"TARGET_ID_TAG_ELEMENT_NOT_FOUND"}):document.getElementById(t).innerHTML='<div class="idkids-sdk"><a href="http://localhost:3000/auth?from='+window.location.origin.replace(new RegExp("/","g"),"R|")+"&redirect="+this.options.callback_url.replace(new RegExp("/","g"),"|")+"&secret="+this.options.secret+'" class="auth_button" data-action="login"><div class="avatar"></div><div class="label">CONNEXION</div></a></div>'},e({status:"sdk instance created"},this.options)};