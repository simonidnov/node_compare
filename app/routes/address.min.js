var express=require("express"),_=require("underscore"),address=express.Router(),Address_controller=require("../controllers/address_controller"),Auth_helper=require("../helpers/auth_helper"),language_helper=require("../helpers/languages_helper"),uri_helper=require("../helpers/uri_helper"),lang=require("../public/languages/auth_lang");
address.use(function(a,b,d){b.setHeader("Access-Control-Allow-Origin","*");b.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept");b.setHeader("Access-Control-Allow-Methods","GET, PUT, POST, DELETE");Auth_helper.validate_session(a,function(a){200===a.status?d():b.redirect(307,"/auth")})});
address.get("/",function(a,b,d){Address_controller.get(a,b,function(c){b.redirect(307,"/account/addresses"+a.url.replace("/",""))})}).post("/",function(a,b,d){console.log("ADD ADDRESS");"undefined"!==typeof a.body.data&&(a.body=a.body.data);console.log("ADD ADDRESS ",a.body);Address_controller.create(a,b,function(c){console.log("CREATED ? ",c);b.status(c.status).send(Auth_helper.addParams(c,a))})}).put("/",function(a,b,d){"undefined"!==typeof a.body.data&&(a.body=a.body.data);Address_controller.update(a,
b,function(c){b.status(c.status).send(Auth_helper.addParams(c,a))})})["delete"]("/",function(a,b,d){"undefined"!==typeof a.body.data&&(a.body=a.body.data);Address_controller["delete"](a,function(c){b.status(c.status).send(Auth_helper.addParams(c,a))})});module.exports=address;
