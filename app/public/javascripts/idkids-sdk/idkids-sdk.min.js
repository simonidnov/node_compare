var idkids_jssdk=function(e,t){this.options=e,this.callback=t,this.inited=!1,this.api={user:null,options:null,get:function(e,t,s){this.call("GET",e,t,s)},post:function(e,t,s){this.call("POST",e,t,s)},put:function(e,t,s){this.call("PUT",e,t,s)},"delete":function(e,t,s){this.call("DELETE",e,t,s)},call:function(e,t,s,o){this.show_loader(),s=this.add_params(s),dataType="json",("POST"===e||"PUT"===e||"DELETE"===e)&&(dataType="json",s=JSON.stringify(s)),jQuery.ajax(t,{method:e,contentType:"application/json",dataType:dataType,data:s}).done($.proxy(function(e){console.log("IS DONE :::: ",e),"undefined"!=typeof e.updated_token&&(this.user.token=e.updated_token,this.store("idkids_local_user",this.user)),o(e)},this)).fail(function(e){console.log("fail ",e)}).always($.proxy(function(e){this.hide_loader(),console.log("always ",e)},this))},get_user_status:function(){return this.set_user(),null===this.user?{status:"not_connected",infos:"call api.get('me')"}:{status:"logged",token:this.user.token,id:this.user.id,device:this.user.device}},get_params:function(){},show_loader:function(){0===$(".idkids_jssdk.loader").length&&$("body").append('<div class="idkids_jssdk loader"><div class="centered"><svg version="1.1" id="Calque_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"	 viewBox="0 0 256 256" style="enable-background:new 0 0 256 256;" xml:space="preserve"><style type="text/css">	.st0{fill:none;stroke:#4F555A;stroke-width:28;stroke-miterlimit:10;}	.st1{fill:#C93632;}</style><circle class="st0" cx="128" cy="128" r="53"/><circle class="st1" cx="128" cy="128" r="26"/></svg></div></div>')},hide_loader:function(){$(".idkids_jssdk.loader").remove()},add_params:function(e){return e.options=this.options,e.options.from_origin=window.location.origin,this.user&&(e.options.user_token=this.user.token,e.options.user_id=this.user._id,e.options.user_secret=this.user.secret,e.options.user_device=this.user.current_device),e},reset_user:function(e){var t=new URL(window.location.href),s=t.searchParams.get("idkids-token");if(null!==s){var o={token:t.searchParams.get("idkids-token"),_id:t.searchParams.get("idkids-id"),secret:t.searchParams.get("idkids-secret"),device:t.searchParams.get("idkids-device")};this.store("idkids_local_user",o),this.set_user(),e(o),window.location.href=window.location.pathname}},set_user:function(){this.getStore("idkids_local_user")},store:function(e,t){try{window.localStorage.setItem(e,JSON.stringify(t))}catch(s){console.log("error ::: ",s)}},getStore:function(e){try{this.user=JSON.parse(window.localStorage.getItem(e))}catch(t){console.log("error ::: ",t)}}},this.logout=function(){this.api.store("idkids_local_user","")},this.api.options=e,this.init=function(e){this.api.reset_user(function(e){}),this.api.get("/me/from",{},function(t){e(t)})},this.isLogged=function(e){e(this.api.get_user_status())},this.template=function(e,t,s){$.get("/templating/"+e,t,function(e){s(e)})},this.createAuthbutton=function(e,t){null===document.getElementById(e)?t({status:"error",message:"TARGET_ID_TAG_ELEMENT_NOT_FOUND"}):document.getElementById(e).innerHTML='<div class="idkids-sdk"><a href="http://localhost:3000/auth?from='+window.location.origin.replace(new RegExp("/","g"),"R|")+"&redirect="+this.options.callback_url.replace(new RegExp("/","g"),"|")+"&secret="+this.options.secret+'" class="auth_button" data-action="login"><div class="avatar"></div><div class="label">CONNEXION</div></a></div>'},t({status:"sdk instance created"},this.options)};