var express=require("express"),api=express.Router(),Apps_controller=require("../controllers/apps_controller"),Pages_controller=require("../controllers/pages_controller"),Auth_controller=require("../controllers/auth_controller"),Email_controller=require("../controllers/email_controller"),Auth_helper=require("../helpers/auth_helper"),language_helper=require("../helpers/languages_helper"),uri_helper=require("../helpers/uri_helper"),lang=require("../public/languages/auth_lang");
api.use(function(a,b,d){b.setHeader("Access-Control-Allow-Origin","*");b.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept");b.setHeader("Access-Control-Allow-Methods","GET, PUT, POST, DELETE");b.setHeader("Content-Type","application/json");var c=a.query;if("PUT"===a.method||"POST"===a.method||"DELETE"===a.method)c=a.body;Auth_helper.validate_user(c,a.get("host"),function(c){200===c.status?d():b.status(c.status).send(Auth_helper.addParams(c,a))})});
api.get("/",function(a,b,d){b.status(200).send(Auth_helper.addParams({title:"API"},a))}).post("/",function(a,b,d){b.status(200).send(Auth_helper.addParams({title:"POST API"},a))}).put("/",function(a,b,d){b.status(200).send(Auth_helper.addParams({title:"PUT API"},a))})["delete"]("/",function(a,b,d){b.status(200).send(Auth_helper.addParams({title:"DELETE API"},a))}).get("/apps",function(a,b,d){Apps_controller.get(a,{},function(c){b.status(c.status).send(Auth_helper.addParams(c,a))})}).get("/apps/:action",
function(a,b,d){switch(action){case "valid_sdk":Apps_controller.validate(a,b,function(c){b.status(c.status).send(Auth_helper.addParams(c,a))});break;default:b.status(200).send({status:"Hello",title:"action non d\u00e9finie",message:"votre requ\u00eate n'est pas reconnue par l'api"})}}).post("/apps",function(a,b,d){Apps_controller.create(a,b,function(c){b.status(c.status).send(Auth_helper.addParams(c,a))})}).put("/apps",function(a,b,d){Apps_controller.update(a,b,function(c){b.status(c.status).send(Auth_helper.addParams(c,
a))})})["delete"]("/apps",function(a,b,d){Apps_controller["delete"](a,b,function(c){b.status(c.status).send(Auth_helper.addParams(c,a))})}).get("/pages",function(a,b,d){console.log("GET PAGE");Pages_controller.get(a,b,function(c){b.status(c.status).send(Auth_helper.addParams(c,a))})}).post("/pages",function(a,b,d){console.log("POST PAGE");Pages_controller.create(a,b,function(c){b.status(c.status).send(Auth_helper.addParams(c,a))})}).put("/pages",function(a,b,d){Pages_controller.update(a,b,function(c){b.status(c.status).send(Auth_helper.addParams(c,
a))})})["delete"]("/pages",function(a,b,d){Pages_controller["delete"](a,b,function(c){b.status(c.status).send(Auth_helper.addParams(c,a))})}).post("/request_validation_code",function(a,b,d){Auth_controller.request_validation_code(a,b,function(c){200===c.status?Email_controller.validate_account(a,c,function(c){b.status(c.status).send(Auth_helper.addParams(c,a))}):b.status(c.status).send(Auth_helper.addParams(c,a))})}).put("/change_password",function(a,b,d){a.email=a.body.decoded.email;a.password=a.body.new_password;
Auth_controller.update_password(a.body,b,function(c){console.log(c);b.status(200).send(Auth_helper.addParams(c,a))})}).post("/contact",function(a,b,d){require("../controllers/contact_controller").create(a,b,function(a){b.status(a.status).send(a)})}).get("/users/:any",function(a,b,d){b.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).post("/users/:any",function(a,b,d){b.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).put("/users/:any",function(a,b,d){b.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})})["delete"]("/users/:any",
function(a,b,d){Auth_controller.unregister(a,b,function(a){b.status(200).send({title:"USER DELETED",datas:a})})}).get("/oauth/:any",function(a,b,d){b.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).post("/oauth/:any",function(a,b,d){b.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).put("/oauth/:any",function(a,b,d){b.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})})["delete"]("/oauth/:any",function(a,b,d){b.status(200).send({title:"SERVICE CURRENTLY UNAIVALABLE"})}).get("/send-sms",
function(a,b,d){require("request").post("https://textbelt.com/text",{form:{phone:"+33768651457",message:"Hello world",key:"57652f35ce6bd73e072a37701775ee0e3dec4194VPqWleqqdvVMWkw0VLpUasUvu"}},function(a,b,d){})});module.exports=api;
