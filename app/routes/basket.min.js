var express=require("express"),basket=express.Router(),Basket_controller=require("../controllers/basket_controller"),Auth_helper=require("../helpers/auth_helper"),language_helper=require("../helpers/languages_helper"),uri_helper=require("../helpers/uri_helper"),lang=require("../public/languages/auth_lang");
basket.use(function(a,b,c){b.setHeader("Access-Control-Allow-Origin","*");b.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept");b.setHeader("Access-Control-Allow-Methods","GET, PUT, POST, DELETE");Auth_helper.validate_admin(a,function(b){200===b.status?(a.body.isAdmin=!0,a.query.isAdmin=!0):(a.body.isAdmin=!1,a.query.isAdmin=!1)});var d=a.query;if("PUT"===a.method||"POST"===a.method||"DELETE"===a.method)d=a.body;Auth_helper.validate_user(d,a.get("host"),function(a){200===
a.status?c():(console.log("USER NOT VALID"),b.status(a.status).send(a.datas))})});
basket.get("/",function(a,b,c){Basket_controller.get(a,b,function(a){b.status(a.status).send(a.datas)})}).get("/amount",function(a,b,c){Basket_controller.getAmount(a,b,function(a){b.status(a.status).send(a.datas)})}).post("/",function(a,b,c){Basket_controller.create(a.body.data,b,function(a){b.status(a.status).send({status:a.status,response_display:{title:"Ajout\u00e9",message:"Votre produit a bien \u00e9t\u00e9 ajout\u00e9 dans votre panier."}})})}).put("/",function(a,b,c){Basket_controller.update(a.body.data,
b,function(a){b.status(a.status).send({status:a.status,infos:a.datas})})})["delete"]("/",function(a,b,c){Basket_controller["delete"](a,b,function(a){b.status(a.status).send({status:a.status,infos:a.datas})})});module.exports=basket;
