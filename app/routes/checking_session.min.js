var express=require("express"),checking_session=express.Router(),Auth_model=require("../models/auth_model"),auth_helper=require("../helpers/auth_helper"),language_helper=require("../helpers/languages_helper"),uri_helper=require("../helpers/uri_helper"),lang=require("../public/languages/auth_lang");checking_session.use(function(e,r,s){r.setHeader("Access-Control-Allow-Origin","*"),r.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),r.setHeader("Access-Control-Allow-Methods","GET, PUT, POST, DELETE"),s()}),checking_session.get("/",function(e,r,s){void 0!==e.query._id&&void 0!==e.query.secret&&void 0!==e.query.token?"undefined"===e.query._id?(r.redirect(307,"/auth"),r.end()):Auth_model.checking_session(e,e.query._id,function(e){void 0!==e.datas.password?(r.redirect(307,"/account?idkids-token="+e.datas.token+"&idkids-id="+e.datas._id+"&idkids-device="+e.datas.current_device),r.end()):(r.redirect(307,"/auth"),r.end())}):(r.render("auth/checking_session",{}),r.end())}),module.exports=checking_session;